--Returns a count of how many times each individual product with 'Ultrasound' in the description was used each individual day during a given time frame.
SELECT dtl.PRODUCT_LINE_ID, dtl.PRODUCT_SEQ_ID, prod.LONG_DESCRIPTION, COUNT(dtl.ORDER_ITEM_DATETIME), to_char(dtl.ORDER_ITEM_DATETIME,'mm/dd/yyyy/DAY') FROM UVIS_ORDER_DTL dtl, UVIS_MR_EPISODE ep, UVIS_PRODUCT prod, UVIS_PATIENT patient WHERE dtl.ORDER_ID = ep.EPISODE_ID AND ep.PATIENT_ID = patient.PATIENT_ID AND (patient.SPECIES_ID = '6' OR patient.SPECIES_ID = '7') AND dtl.PRODUCT_LINE_ID = prod.PRODUCT_LINE_ID AND dtl.PRODUCT_SEQ_ID = prod.PRODUCT_SEQ_ID AND prod.LONG_DESCRIPTION LIKE '%ULTRASOUND%' AND dtl.ORDER_ITEM_DATETIME BETWEEN '1-MAY-15' AND '1-AUG-15' AND dtl.ORDER_ITEM_STATUS = 'FN' GROUP BY dtl.PRODUCT_LINE_ID, dtl.PRODUCT_SEQ_ID, prod.LONG_DESCRIPTION, to_char(dtl.ORDER_ITEM_DATETIME,'mm/dd/yyyy/DAY');
--Returns a count of how many times any product with 'Ultrasound' in the description was used each individual day during a given time frame.
SELECT COUNT(dtl.ORDER_ITEM_DATETIME), to_char(dtl.ORDER_ITEM_DATETIME,'mm/dd/yyyy/DAY') FROM UVIS_ORDER_DTL dtl, UVIS_MR_EPISODE ep, UVIS_PRODUCT prod, UVIS_PATIENT patient WHERE dtl.ORDER_ID = ep.EPISODE_ID AND ep.PATIENT_ID = patient.PATIENT_ID AND (patient.SPECIES_ID = '6' OR patient.SPECIES_ID = '7') AND dtl.PRODUCT_LINE_ID = prod.PRODUCT_LINE_ID AND dtl.PRODUCT_SEQ_ID = prod.PRODUCT_SEQ_ID AND prod.LONG_DESCRIPTION LIKE '%ULTRASOUND%' AND dtl.ORDER_ITEM_DATETIME BETWEEN '1-MAY-15' AND '1-AUG-15' AND dtl.ORDER_ITEM_STATUS = 'FN' GROUP BY to_char(dtl.ORDER_ITEM_DATETIME,'mm/dd/yyyy/DAY');